<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jointown.zy.common.dao.BreedMapper" >
  <resultMap id="BaseResultMap" type="com.jointown.zy.common.model.Breed" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="BREED_ID" property="breedId" jdbcType="DECIMAL" />
    <result column="BREED_CODE" property="breedCode" jdbcType="VARCHAR" />
    <result column="BREED_NAME" property="breedName" jdbcType="VARCHAR" />
    <result column="BREED_CNAME" property="breedCname" jdbcType="VARCHAR" />
    <result column="BREED_COUNT_UNIT" property="breedCountUnit" jdbcType="VARCHAR" />
    <result column="BREED_STANDARD_LEVEL" property="breedStandardLevel" jdbcType="VARCHAR" />
    <result column="BREED_PLACE" property="breedPlace" jdbcType="VARCHAR" />
    <result column="CREATE_TIME" property="createTime" jdbcType="TIMESTAMP" />
    <result column="UPDATE_TIME" property="updateTime" jdbcType="TIMESTAMP" />
    <result column="STATUS" property="status" jdbcType="DECIMAL" />
    <result column="CREATER" property="creater" jdbcType="DECIMAL" />
    <result column="UPDATER" property="updater" jdbcType="DECIMAL" />
  </resultMap>
  <resultMap id="ResultMapWithBLOBs" type="com.jointown.zy.common.model.Breed" extends="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="BREED_EXTEND" property="breedExtend" jdbcType="CLOB" />
  </resultMap>
  
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    BREED_ID, BREED_CODE, BREED_NAME, BREED_CNAME, BREED_COUNT_UNIT, BREED_STANDARD_LEVEL, 
    BREED_PLACE, CREATE_TIME, UPDATE_TIME, STATUS, CREATER, UPDATER
  </sql>
  <sql id="Blob_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    BREED_EXTEND
  </sql>
  
  <sql id="Where_Clause" >
		<where>
			<if test="breedId != null" >
			  and BREED_ID = #{breedId,jdbcType=DECIMAL}
			</if>
			<if test="breedCode != null" >
			  and BREED_CODE = #{breedCode,jdbcType=VARCHAR}
			</if>
			<if test="breedName != null" >
			  and BREED_NAME = #{breedName,jdbcType=VARCHAR}
			</if>
			
			<if test="status != null" >
			  and STATUS = #{status,jdbcType=DECIMAL}
			</if>
			<if test="updateTime != null" >
			  and UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP}
			</if>
			<if test="creater != null" >
			  and CREATER = #{creater,jdbcType=DECIMAL}
			</if>
			<if test="updater != null" >
			  and UPDATER = #{updater,jdbcType=DECIMAL}
			</if>
			<if test="sqlStr !=null">
			  ${sqlStr}
			</if>
		</where>
	</sql>
  
  <sql id="OrderBy_Clause">
		<if test="sqlSort != null" >
		  order by ${sqlSort}
		</if>
	</sql>
	
  <select id="selectList" parameterType="com.jointown.zy.common.model.Breed"  resultMap="BaseResultMap" >
  	select <include refid="Base_Column_List" /> from boss.BREED <include refid="Where_Clause" /> <include refid="OrderBy_Clause" />
  </select>
  
  <select id="selectByPrimaryKey" resultMap="ResultMapWithBLOBs" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from boss.BREED
    where BREED_ID = #{breedId,jdbcType=DECIMAL}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from boss.BREED
    where BREED_ID = #{breedId,jdbcType=DECIMAL}
  </delete>
  
  <insert id="insert" parameterType="com.jointown.zy.common.model.Breed" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey resultType="java.lang.Long" keyProperty="breedId" order="BEFORE">
   	select boss.SEQ_BREED.nextVal as BREED_ID
   		from dual
  	</selectKey>
    insert into boss.BREED (BREED_ID, BREED_CODE, BREED_NAME, 
      BREED_CNAME, BREED_COUNT_UNIT, BREED_STANDARD_LEVEL, 
      BREED_PLACE, CREATE_TIME, UPDATE_TIME, 
      STATUS, CREATER, UPDATER, BREED_EXTEND
      )
    values (#{breedId,jdbcType=DECIMAL}, #{breedCode,jdbcType=VARCHAR}, #{breedName,jdbcType=VARCHAR}, 
      #{breedCname,jdbcType=VARCHAR}, #{breedCountUnit,jdbcType=VARCHAR}, #{breedStandardLevel,jdbcType=VARCHAR}, 
      #{breedPlace,jdbcType=VARCHAR}, #{createTime,jdbcType=TIMESTAMP}, #{updateTime,jdbcType=TIMESTAMP}, 
      #{status,jdbcType=DECIMAL}, #{creater,jdbcType=DECIMAL}, #{updater,jdbcType=DECIMAL}, #{breedExtend,jdbcType=CLOB}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.jointown.zy.common.model.Breed" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into boss.BREED
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="breedId != null" >
        BREED_ID,
      </if>
      <if test="breedCode != null" >
        BREED_CODE,
      </if>
      <if test="breedName != null" >
        BREED_NAME,
      </if>
      <if test="breedCname != null" >
        BREED_CNAME,
      </if>
      <if test="breedCountUnit != null" >
        BREED_COUNT_UNIT,
      </if>
      <if test="breedStandardLevel != null" >
        BREED_STANDARD_LEVEL,
      </if>
      <if test="breedPlace != null" >
        BREED_PLACE,
      </if>
      <if test="createTime != null" >
        CREATE_TIME,
      </if>
      <if test="updateTime != null" >
        UPDATE_TIME,
      </if>
      <if test="status != null" >
        STATUS,
      </if>
      <if test="creater != null" >
        CREATER,
      </if>
      <if test="updater != null" >
        UPDATER,
      </if>
      <if test="breedExtend != null" >
        BREED_EXTEND,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="breedId != null" >
        #{breedId,jdbcType=DECIMAL},
      </if>
      <if test="breedCode != null" >
        #{breedCode,jdbcType=VARCHAR},
      </if>
      <if test="breedName != null" >
        #{breedName,jdbcType=VARCHAR},
      </if>
      <if test="breedCname != null" >
        #{breedCname,jdbcType=VARCHAR},
      </if>
      <if test="breedCountUnit != null" >
        #{breedCountUnit,jdbcType=VARCHAR},
      </if>
      <if test="breedStandardLevel != null" >
        #{breedStandardLevel,jdbcType=VARCHAR},
      </if>
      <if test="breedPlace != null" >
        #{breedPlace,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null" >
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="status != null" >
        #{status,jdbcType=DECIMAL},
      </if>
      <if test="creater != null" >
        #{creater,jdbcType=DECIMAL},
      </if>
      <if test="updater != null" >
        #{updater,jdbcType=DECIMAL},
      </if>
      <if test="breedExtend != null" >
        #{breedExtend,jdbcType=CLOB},
      </if>
    </trim>
  </insert>
  
  <update id="updateByPrimaryKeySelective" parameterType="com.jointown.zy.common.model.Breed" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update boss.BREED
    <set >
      <if test="breedCode != null" >
        BREED_CODE = #{breedCode,jdbcType=VARCHAR},
      </if>
      <if test="breedName != null" >
        BREED_NAME = #{breedName,jdbcType=VARCHAR},
      </if>
      <if test="breedCname != null" >
        BREED_CNAME = #{breedCname,jdbcType=VARCHAR},
      </if>
      <if test="breedCountUnit != null" >
        BREED_COUNT_UNIT = #{breedCountUnit,jdbcType=VARCHAR},
      </if>
      <if test="breedStandardLevel != null" >
        BREED_STANDARD_LEVEL = #{breedStandardLevel,jdbcType=VARCHAR},
      </if>
      <if test="breedPlace != null" >
        BREED_PLACE = #{breedPlace,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null" >
        UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="status != null" >
        STATUS = #{status,jdbcType=DECIMAL},
      </if>
      <if test="creater != null" >
        CREATER = #{creater,jdbcType=DECIMAL},
      </if>
      <if test="updater != null" >
        UPDATER = #{updater,jdbcType=DECIMAL},
      </if>
      <if test="breedExtend != null" >
        BREED_EXTEND = #{breedExtend,jdbcType=CLOB},
      </if>
    </set>
    where BREED_ID = #{breedId,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.jointown.zy.common.model.Breed" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update boss.BREED
    set BREED_CODE = #{breedCode,jdbcType=VARCHAR},
      BREED_NAME = #{breedName,jdbcType=VARCHAR},
      BREED_CNAME = #{breedCname,jdbcType=VARCHAR},
      BREED_COUNT_UNIT = #{breedCountUnit,jdbcType=VARCHAR},
      BREED_STANDARD_LEVEL = #{breedStandardLevel,jdbcType=VARCHAR},
      BREED_PLACE = #{breedPlace,jdbcType=VARCHAR},
      CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
      STATUS = #{status,jdbcType=DECIMAL},
      CREATER = #{creater,jdbcType=DECIMAL},
      UPDATER = #{updater,jdbcType=DECIMAL},
      BREED_EXTEND = #{breedExtend,jdbcType=CLOB}
    where BREED_ID = #{breedId,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.jointown.zy.common.model.Breed" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update boss.BREED
    set BREED_CODE = #{breedCode,jdbcType=VARCHAR},
      BREED_NAME = #{breedName,jdbcType=VARCHAR},
      BREED_CNAME = #{breedCname,jdbcType=VARCHAR},
      BREED_COUNT_UNIT = #{breedCountUnit,jdbcType=VARCHAR},
      BREED_STANDARD_LEVEL = #{breedStandardLevel,jdbcType=VARCHAR},
      BREED_PLACE = #{breedPlace,jdbcType=VARCHAR},
      CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
      STATUS = #{status,jdbcType=DECIMAL},
      CREATER = #{creater,jdbcType=DECIMAL},
      UPDATER = #{updater,jdbcType=DECIMAL}
    where BREED_ID = #{breedId,jdbcType=DECIMAL}
  </update>
  <!-- add by fanyuna 查询当前类目的品种 -->
  <select id="selectBreedByCat" parameterType="java.lang.Long" resultMap="BaseResultMap">
  	 select <include refid="Base_Column_List" /> from boss.BREED where status=1
  	 and EXISTS (select 1 from boss.breed_category where  breed.breed_id =breed_category.breed_id and status=1 and 
	 EXISTS (select 1 from  boss.categorys where id=#{categoryId,jdbcType=DECIMAL} and status=1 and boss.breed_category.categorys_id=categorys.id)) 
  </select>
  
  <!-- add by chengchang 根据要求查询模糊查询出符合要求的数据 -->
  <select id="selectBreedByPz" parameterType="com.jointown.zy.common.model.Page" resultMap="BaseResultMap">
  select * from(
  	 select 
	  	 BREED_ID,
	       BREED_CODE,
	       BREED_NAME,
	       BREED_CNAME,
	       nvl ((select distinct a.dict_value
	              from dict_info a
	             where a.dict_code = BREED_COUNT_UNIT), BREED_COUNT_UNIT) as BREED_COUNT_UNIT,
	       BREED_STANDARD_LEVEL,
	       BREED_PLACE,
	       CREATE_TIME,
	       UPDATE_TIME,
	       STATUS,
	       CREATER,
	       UPDATER 
  	 from boss.BREED
  	  where status=1
  	 <if test="params.name != null and params.name != ''">
  	 	and (breed_name like  '%'||#{params.name,jdbcType=VARCHAR}||'%' or breed_cname like '%'||#{params.name,jdbcType=VARCHAR}||'%' )
  	 </if>
  	 <if test="params.code != null and params.code !=''">
  	 	and breed_code like '%'||#{params.code,jdbcType=VARCHAR}||'%'
  	 </if>
  	 <if test="params.place != null and params.place!=''">
  	 	and breed_place like '%'||#{params.place,jdbcType=VARCHAR}||'%'
  	 </if>
  	 order by BREED_ID desc
  	 )
  </select>
  
  
  <!--增加自定义排序，增加cindex排序字段，关联品种时间2个字段，然后根据规则排序， alert by Mr.song 2015.4.3  -->
  <!-- add by fanyuna 查询当前目录及所有子类目下的品种并标识其上级路径 -->
  <select id="selectBreedInfoBy" parameterType="com.jointown.zy.common.model.Page" resultType="java.util.Map">
  	   select b.*,bcc.cindex,bcc.id as breed_category_id,bcc.category_id,bcc.CATEGORYS_PATH from  
	   (select breed_id,breed_name,breed_code,breed_cname,breed_standard_level,breed_count_unit,breed_place from boss.breed where status=1) b 
	   inner join 
	    (   select bc.id,bc.cindex,bc.createtime,bc.breed_id,ca.*  from (
	        select * from boss.breed_category where status=1) bc inner join 
	        (select id as category_id,CATEGORYS_PATH from  boss.categorys where id=#{params.categoryId,jdbcType=DECIMAL} and status=1 
	        UNION all
			    select id as category_id,CATEGORYS_PATH from boss.categorys where status=1 START WITH parent_id=#{params.categoryId,jdbcType=DECIMAL} CONNECT by PRIOR id= parent_id) ca
	        on bc.categorys_id = ca.category_id
	        ) bcc
	     on b.breed_id = bcc.breed_id
	     where 1=1
	     <if test="params.name != null and params.name !='' ">
	  	 	and (breed_name like  '%'||#{params.name,jdbcType=VARCHAR}||'%' or breed_cname like '%'||#{params.name,jdbcType=VARCHAR}||'%' )
	  	 </if>
	  	 <if test="params.code != null and params.code !='' ">
	  	 	and breed_code like '%'||#{params.code,jdbcType=VARCHAR}||'%'
	  	 </if>
	  	 <if test="params.place != null and params.place !='' ">
	  	 	and breed_place like '%'||#{params.place,jdbcType=VARCHAR}||'%'
	  	 </if>
	     order by cindex desc,createtime asc
  </select>
  
  <!-- 模糊查询通过输入breed_name,breed_cname, -->
  <!-- add by fanyuna 查询指定类目没挂的品种， 按添加时间降序，品种名称，编码，别名，产地，查询条件模糊查询 -->
  <select id="selectBreedByCategory" parameterType="com.jointown.zy.common.model.Page" resultMap="BaseResultMap">
  		select <include refid="Base_Column_List" /> from boss.BREED b
  		where status=1 and  NOT EXISTS (select 1 from boss.breed_category bc where  b.breed_id= bc.breed_id and categorys_id=#{params.categoryId,jdbcType=DECIMAL} and status=1)
  		<if test="params.name != null and params.name!='' ">
  	 		and (breed_name like  '%'||#{params.name,jdbcType=VARCHAR}||'%' or breed_cname like '%'||#{params.name,jdbcType=VARCHAR}||'%' or 
  	 			breed_code like '%'||#{params.name,jdbcType=VARCHAR}||'%' or BREED_PLACE like '%'||#{params.name,jdbcType=VARCHAR}||'%')
  	 	</if>
  		order by CREATE_TIME desc
  </select>
  
  <!-- 精确查询品种名称 -->
  <select id="selectBreedByBreedName" parameterType="java.lang.String" resultMap="BaseResultMap">
  		select b.BREED_ID,b.BREED_NAME,b.BREED_CNAME from BOSS.BREED b where b.STATUS = 1
  	 	and b.BREED_NAME = #{breedName, jdbcType=VARCHAR}
  </select>
  
  <!-- 模糊查询品种名称 -->
  <select id="selectBreedsByName" parameterType="java.lang.String" resultMap="BaseResultMap">
  		select b.BREED_ID,b.BREED_NAME,b.BREED_CNAME from BOSS.BREED b where b.STATUS = 1
  	 	and (b.BREED_NAME like CONCAT(CONCAT('%', #{breedName, jdbcType=VARCHAR}),'%') or b.BREED_CNAME like CONCAT(CONCAT('%', #{breedName, jdbcType=VARCHAR}),'%'))
  </select>
  
  <!-- add by fanyuna 2015.10.13 模糊匹配品种名 -->
  <select id="selectBreedByKeyword" parameterType="java.lang.String" resultMap="BaseResultMap" >
  	select <include refid="Base_Column_List" /> from boss.BREED b where b.STATUS = 1
  	and breed_name like  '%'||#{breedName,jdbcType=VARCHAR}||'%'
  </select>
</mapper>